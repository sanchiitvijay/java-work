<div class="card">
  <button (click)="goBack()" class="btn btn-primary">‚Üê Back to Books</button>
  
  <h1>Book Copies</h1>
  <h2 *ngIf="book">{{ book.title }} by {{ book.author }}</h2>

  <button (click)="showForm = !showForm" class="btn btn-success mb-2">
    {{ showForm ? 'Cancel' : 'Add New Copy' }}
  </button>

  <div *ngIf="showForm" class="card" style="background: #f8f9fa;">
    <h3>Add New Copy</h3>
    <div class="form-group">
      <label>Rack Number</label>
      <input type="text" [(ngModel)]="newCopy.rackNo" placeholder="e.g., A1-001">
    </div>
    <div class="form-group">
      <label>Status</label>
      <select [(ngModel)]="newCopy.status">
        <option value="AVAILABLE">Available</option>
        <option value="DAMAGED">Damaged</option>
        <option value="LOST">Lost</option>
      </select>
    </div>
    <button (click)="addCopy()" class="btn btn-success">Create Copy</button>
  </div>

  <table *ngIf="copies.length > 0">
    <thead>
      <tr>
        <th>Copy ID</th>
        <th>Rack Number</th>
        <th>Status</th>
        <th>Actions</th>
      </tr>
    </thead>
    <tbody>
      <tr *ngFor="let copy of copies">
        <td>{{ copy.id }}</td>
        <td>{{ copy.rackNo }}</td>
        <td>
          <span class="badge" [ngClass]="{
            'badge-available': copy.status === 'AVAILABLE',
            'badge-issued': copy.status === 'ISSUED',
            'badge-damaged': copy.status === 'DAMAGED' || copy.status === 'LOST'
          }">
            {{ copy.status }}
          </span>
        </td>
        <td>
          <select (change)="updateCopyStatus(copy, $any($event.target).value)" [value]="copy.status">
            <option value="AVAILABLE">Available</option>
            <option value="ISSUED">Issued</option>
            <option value="DAMAGED">Damaged</option>
            <option value="LOST">Lost</option>
          </select>
          <button (click)="deleteCopy(copy.id!)" class="btn btn-danger" 
                  [disabled]="copy.status === 'ISSUED'">
            Delete
          </button>
        </td>
      </tr>
    </tbody>
  </table>

  <p *ngIf="copies.length === 0" class="text-center mt-2">No copies found for this book.</p>
</div>
